<%= turbo_frame_tag "meeting_chats" do %>
  <div class="flex flex-col h-full">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-sm font-semibold text-gray-900 uppercase tracking-wide">Chat</h2>
      <%= link_to "All chats", meeting_chats_path(@meeting),
            class: "text-sm font-medium text-indigo-600 hover:text-indigo-500",
            data: { turbo_frame: "meeting_chats" } %>
    </div>

    <%= turbo_stream_from "chat_#{@chat.id}" %>

    <div id="messages" class="space-y-3 flex-1 overflow-y-auto" data-controller="autoscroll">
      <% @chat.messages.where.not(role: "system").each do |message| %>
        <%= render "messages/message", message: message %>
      <% end %>
    </div>

    <%= render "meeting_messages/form", meeting: @meeting, chat: @chat %>
  </div>
<% end %>
