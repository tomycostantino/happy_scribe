<div id="floating-chat" data-controller="floating-chat" data-turbo-permanent>
  <%# Chat panel â€” hidden by default %>
  <div data-floating-chat-target="panel"
       class="hidden fixed bottom-24 right-6 w-96 h-[500px] bg-white rounded-2xl shadow-2xl border border-gray-200 flex flex-col overflow-hidden z-50">
    <%# Chat content loaded via Turbo Frame (includes header) %>
    <div class="flex-1 min-h-0">
      <%= turbo_frame_tag "floating_chat",
                          src: chats_floating_index_path,
                          loading: :lazy,
                          class: "flex flex-col h-full",
                          data: { floating_chat_target: "frame" } do %>
        <div class="flex items-center justify-center h-full">
          <div class="animate-pulse text-gray-400 text-sm">Loading...</div>
        </div>
      <% end %>
    </div>
  </div>

  <%# Floating button %>
  <button data-action="click->floating-chat#toggle"
          data-floating-chat-target="button"
          class="fixed bottom-6 right-6 w-14 h-14 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 z-50 cursor-pointer">
    <%# Chat icon (shown when closed) %>
    <%= chat_bubble_icon(css_class: "h-6 w-6", data: { floating_chat_target: "openIcon" }) %>
    <%# Close icon (shown when open) %>
    <%= close_icon(css_class: "hidden h-6 w-6", data: { floating_chat_target: "closeIcon" }) %>
  </button>
</div>
