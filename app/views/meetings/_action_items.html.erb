<% if meeting.action_items.any? %>
  <details class="bg-white shadow-sm ring-1 ring-gray-900/5 rounded-lg group">
    <summary class="px-6 py-4 flex items-center justify-between cursor-pointer select-none list-none [&::-webkit-details-marker]:hidden">
      <div class="flex items-center gap-2">
        <svg class="h-4 w-4 text-gray-400 transition-transform group-open:rotate-90" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
        </svg>
        <h2 class="text-sm font-semibold text-gray-900 uppercase tracking-wide">Action Items</h2>
      </div>
      <span class="text-xs text-gray-500">
        <%= meeting.action_items.done.count %>/<%= meeting.action_items.count %> completed
      </span>
    </summary>
    <div class="px-6 py-4 border-t border-gray-100">
      <ul class="divide-y divide-gray-100">
        <% meeting.action_items.order(:created_at).each do |item| %>
          <li class="flex items-start gap-3 py-3 first:pt-0 last:pb-0">
            <div class="pt-0.5">
              <% if item.completed? %>
                <svg class="h-5 w-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              <% else %>
                <svg class="h-5 w-5 text-gray-300" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              <% end %>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm <%= item.completed? ? 'text-gray-400 line-through' : 'text-gray-900' %>">
                <%= item.description %>
              </p>
              <% if item.assignee.present? || item.due_date.present? %>
                <div class="flex items-center gap-3 mt-1">
                  <% if item.assignee.present? %>
                    <span class="text-xs text-gray-500">
                      <svg class="inline h-3 w-3 mr-0.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
                      </svg>
                      <%= item.assignee %>
                    </span>
                  <% end %>
                  <% if item.due_date.present? %>
                    <span class="text-xs <%= item.due_date < Date.current && !item.completed? ? 'text-red-500' : 'text-gray-500' %>">
                      <svg class="inline h-3 w-3 mr-0.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 9v9.75" />
                      </svg>
                      <%= item.due_date.strftime("%b %d") %>
                    </span>
                  <% end %>
                </div>
              <% end %>
            </div>
          </li>
        <% end %>
      </ul>
    </div>
  </details>
<% end %>
